function validationDate(e){var a,n,t;return""==e||!!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)&&(e=e.split("/"),a=parseInt(e[0],10),n=parseInt(e[1],10),!((e=parseInt(e[2],10))<1e3||3e3<e||0==n||12<n))&&(t=[31,28,31,30,31,30,31,31,30,31,30,31],(e%400==0||e%100!=0&&e%4==0)&&(t[1]=29),0<a)&&a<=t[n-1]}function wordCounter(e,a,n=!1){var t=$('input[name="'+e+'"]').val().length;$(".character-"+e).html(t),n?t==a||t==a-1?$("span.character-"+e).removeClass("toh-warning"):$("span.character-"+e).addClass("toh-warning"):a<t?$("span.character-"+e).addClass("toh-warning"):$("span.character-"+e).removeClass("toh-warning")}function settingSweetaler(e){return{title:e,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"YES",cancelButtonText:"NO",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}}function settingSweetalerForPayment(e){return{title:e,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"BUY NOW",cancelButtonText:"LATER",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}}function alertMessage(e){swal(settingSweetaler(e)).then(e=>{e.value&&(window.location.href=baseURL)})}function loginAjax(){var e={email:$("#email_login").val(),password:$("#password_login").val(),remember:$("input[name=remember]").prop("checked")};return $.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({method:"POST",url:baseURL+"/loginAjax",data:e,dataType:"json",beforeSend:function(){$("#pre_ajax_loading").show()},complete:function(){$("#pre_ajax_loading").hide()},success:function(e){var n;"Error"==e.Response?"string"==typeof e.Message?swal({html:'<div class="alert-danger">'+e.Message+"</div>"}):(n="",$.each(e.Message,function(e,a){n+='<div class="alert-danger">'+a+"</div>"}),swal({html:n})):0<=window.location.href.indexOf("add-barcode")?window.location=baseURL+"/barcode/add":window.location=baseURL},error:function(e){swal({html:'<div class="alert-danger">Login failed. Please check your internet connection and try again.</div>'})}}),!1}function registerAjax(){var e={firstname:$("#firstname").val(),email:$("#email").val(),password:$("#password").val(),confirmpassword:$("#confirmpassword").val(),captcha:grecaptcha.getResponse()};return $.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({method:"POST",url:baseURL+"/registerAjax",data:e,beforeSend:function(){$("#pre_ajax_loading_register").show()},complete:function(){$("#pre_ajax_loading_register").hide()},success:function(e){var n,e=$.parseJSON(e);"Error"==e.Response?(grecaptcha.reset(),n="",$.each(e.Message,function(e,a){n+='<div class="alert-danger">'+a+"</div>"}),swal({dangerMode:!0,html:n})):swal({html:'<div class="alert-success">'+e.Message+"</div>"}).then(e=>{e.value&&(0<=window.location.href.indexOf("add-barcode")?window.location=baseURL+"/barcode/add":window.location=baseURL)})},error:function(e){swal({html:'<div class="alert-danger">Registration failed. Please check your internet connection and try again.</div>'})}}),!1}function changepassAjax(){var e={password_old:$("#password_old").val(),password:$("#password_change").val(),confirmpassword:$("#confirmpassword_change").val(),_method:"put"};return $.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({method:"POST",url:baseURL+"/account/changepassAjax",data:e,beforeSend:function(){$("#pre_ajax_loading_changepass").show()},complete:function(){$("#pre_ajax_loading_changepass").hide()},success:function(e){var t=$.parseJSON(e);"Error"==t.Response?$.each(t.Message,function(e,a){var n="";$.each(t.Message,function(e,a){n+='<div class="alert-danger">'+a+"</div>"}),swal({html:n})}):swal({html:'<div class="alert-success">'+t.Message+"</div>"}).then(e=>{e.value&&(window.location.href=baseURL)})},error:function(e){swal({html:'<div class="alert-danger">Change password failed. Please check your internet connection and try again.</div>'})}}),!1}function resetCodeAjax(){var e=$("#email_reset").val();return $.ajax({url:baseURL+"/resetCodeAjax",data:{email:e},beforeSend:function(){$("#pre_ajax_loading_resetcode").show()},complete:function(){$("#pre_ajax_loading_resetcode").hide()},success:function(e){var t=$.parseJSON(e);"Error"==t.Response?"string"==typeof t.Message?swal({html:'<div class="alert-danger">'+t.Message+"</div>"}):$.each(t.Message,function(e,a){var n="";$.each(t.Message,function(e,a){n+='<div class="alert-danger">'+a+"</div>"}),swal({html:n})}):swal({html:'<div class="alert-success">'+t.Message+"</div>"}).then(e=>{e.value&&$("#close-popup").trigger("click")})},error:function(e){swal({html:'<div class="alert-danger">Reset code failed. Please check your internet connection and try again.</div>'})}}),!1}function resetpassAjax(){var e={email:$("#email_user").val(),reset_code:$("#reset_code").val(),password:$("#batv_password").val(),confirmpassword:$("#batv_confirmpassword").val(),_method:"put"};return $.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({method:"POST",url:baseURL+"/resetpassAjax",data:e,success:function(e){var t=$.parseJSON(e);"Error"==t.Response?"string"==typeof t.Message?swal({html:'<div class="alert-danger">'+t.Message+"</div>"}):$.each(t.Message,function(e,a){var n="";$.each(t.Message,function(e,a){n+='<div class="alert-danger">'+a+"</div>"}),swal({html:n})}):swal({html:'<div class="alert-success">'+t.Message+"</div>"})},error:function(e){swal({html:'<div class="alert-danger">Reset password failed. Please check your internet connection and try again.</div>'})}}),!1}function checkExist(e,a){for(var n=0;n<a.length;n++)if(a[n].id==e)return n;return-1}function formatNumber(e,a,n){x=(e+="").split(a),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1"+n+"$2");return"$"+(x1+x2).toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}function format_curency(e){if(133<e.length)document.getElementById("numFormatResult").value=e.substr(0,e.length-1);else{e=e.replace(/,/g,""),document.getElementById("numFormatResult").value="",x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");document.getElementById("numFormatResult").value=x1+x2,document.getElementById("result").value=e}}function format_curency_global(e){nStr=(nStr=$("#"+e).html()).replace(/,/g,""),nStr+="",x=nStr.split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");$("#"+e).html(x1+x2)}function format_curency_general(e,a,n){e=e.replace(/,/g,""),document.getElementById(a).value="",x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");document.getElementById(a).value=x1+x2,document.getElementById(n).value=e}function CheckStatusInternet(){navigator.onLine||(window.location.href=baseURL)}function register(){$("#myModalRegister").modal("show")}function loginToAddBarcode(){$("#myModalRegister").modal("show")}function addBarcodeNow(){window.location.href=baseURL+"/barcode/add"}function buyit(){window.location.href=baseURL+"/payment"}$(document).on("hidden.bs.modal",function(e){$(".modal:visible").length&&$("body").addClass("modal-open")}),$(".authenBtn").click(function(){CheckStatusInternet()}),$('input[name="barcode"]').keyup(function(){wordCounter("barcode",13,!0)}),$("#name-barcode").keyup(function(){wordCounter("name",200)}),$('input[name="model"]').keyup(function(){wordCounter("model",50)}),$('input[name="manufacturer"]').keyup(function(){wordCounter("manufacturer",200)}),$('input[name="avg_price_tmp"]').keyup(function(){format_curency(this.value),wordCounter("avg_price",100)}),$('input[name="phone"]').keyup(function(){wordCounter("phone",20)}),$("#name").keyup(function(){wordCounter("name",255)}),$('input[name="address"]').keyup(function(){wordCounter("address",255)}),$('input[name="career"]').keyup(function(){wordCounter("career",255)}),$('input[name="organization"]').keyup(function(){wordCounter("organization",255)}),$("form#form-delete").on("submit",function(e){e.preventDefault();var a=this;swal(settingSweetaler("Are you sure want to delete?")).then(e=>{e.value&&a.submit()})}),$("body").on("click","#add-edit-barcode",function(e){var o=$('input[name="barcode"]').val(),a=$('input[name="name"]').val(),n=$('input[name="model"]').val(),t=$('input[name="manufacturer"]').val(),r=$('input[name="currency_unit"]').val(),s=$('input[name="avg_price_tmp"]').val(),i=CKEDITOR.instances.spec.getData(),c=CKEDITOR.instances.feature.getData(),l=CKEDITOR.instances.description_field.getData(),d="",a=($.each(list_image,function(e,a){d+=a+","}),{data:{barcode:o,name:a,model:n,manufacturer:t,currency_unit:r,avg_price:parseInt(s.replace(",","")),spec:i,feature:c,description:l,str_image:d},beforeSend:function(){$("#pre_ajax_loading_barcode").show()},complete:function(e){var a,n,t,r;$("#pre_ajax_loading_barcode").hide(),$.isEmptyObject(e.responseJSON.error)?(a=baseURL+"/barcode/list",n=[],null!=localStorage.getItem("barcodes")&&(n=JSON.parse(localStorage.getItem("barcodes")),-1!=(t=checkExist(o,n)))&&n.splice(t,1),n.push(e.responseJSON.barcode),localStorage.setItem("barcodes",JSON.stringify(n)),swal({html:'<div class="alert-success">'+e.responseJSON.success+"</div>"}).then(e=>{window.location.href=a})):(r="","string"==typeof e.responseJSON.error?swal(settingSweetalerForPayment(e.responseJSON.error)).then(e=>{e.value&&(window.location.href=baseURL+"/payment")}):($.each(e.responseJSON.error,function(e,a){r+='<div class="alert-danger">'+a+"</div>"}),swal({html:r})))}});$(this).parents("form").ajaxForm(a)}),$(document).ready(function(){$(document).on("click","#imgList img.thumb",function(){window.open($(this).attr("src"),"_blank")}),-1<window.location.href.indexOf("?barcode=")&&format_curency_global("numFormatResult"),-1<window.location.href.indexOf("barcode/edit")&&format_curency($("#numFormatResult").val()),$("#myModalRegister").on("hide.bs.modal",function(){location.reload()}),$("#myModalRegister").on("show.bs.modal",function(){$('#myModalRegister input[type="email"],#myModalRegister input[type="password"],#myModalRegister input[type="text"]').val("")}),$("#myModalRecoverPass").on("show.bs.modal",function(){$('#myModalRecoverPass input[type="email"]').val("")}),$('input[type="password"],input[type="email"],input[type="number"]').on({keydown:function(e){if(32===e.which)return!1},change:function(){this.value=this.value.replace(/\s/g,"")}}),$('#email_login,#password_login,input[name="remember"]').keypress(function(e){if("13"==(e.keyCode||e.which))return loginAjax(),!1}),$("#email_reset").keypress(function(e){if("13"==(e.keyCode||e.which))return resetCodeAjax(),!1}),$("#firstname,#email,#password,#confirmpassword").keypress(function(e){if("13"==(e.keyCode||e.which))return registerAjax(),!1})});